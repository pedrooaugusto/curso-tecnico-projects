<?xml version="1.0" encoding="UTF-8" ?>
<html xmlns="http://www.w3.org/1999/xhtml"
	xmlns:h="http://java.sun.com/jsf/html"
	xmlns:f="http://java.sun.com/jsf/core">
<h:head>
	<title>Cadastro das Turmas</title>
	<style type="text/css">
		*
		{
			margin: 0;
		}
		body {
		background: #b2b3b7;
		}
		h1{color:white;}
		#caixa{
			width: 550px;
			height: 450px;
			margin-left: calc(50% - 275px);
			margin-top: 40px;
			padding: 5px;
			border: solid 1px white;
		}
		            .button{
                margin:1%;
                width:40%;
                border: solid 1px white;
                height: 30px;
                line-height: 30px;
                font-family: 'Segoe UI';
                font-size: 23px;
                background: rgb(102,102,255);
                color:white;
                cursor: pointer;
                text-decoration: none;
                text-align: center;
            }
            .cancelButton
            {
                width:40%;
                margin:1%;
                text-decoration: none;
                color: white;
                border: solid 1px white;
                background: red;
                height: 30px;
                line-height: 30px;
                font-family: 'Segoe UI';
                font-size: 23px;
                display: block;
                text-align: center;
            }
            .button:hover{
                border: solid 1px rgb(102,102,255);
                background: white;
                color:rgb(102,102,255);
            }
		.label
		{
			color: white;
			font-size: 25px;
		}
		td{padding: 5px;}
		select, input[type="text"]
		{
			width: 300px;
			
		}
		th
		{
			text-align: left;
		}
		option, select, input[type="text"],  input[type="submit"], input[type="button"] {
			font-size: 18px; 
			height: 30px;
		}
		/*CSS PARA FAZER A SCROLL APARECER*/
		.historicoProdutos
		{ 
			height: 200px;
		}
		#table-wrapper {
            position:relative;
        }
        #table-scroll {
        
			border: solid 1px white;
			padding: 5px;
			background: #e4e1e1;
            height:200px;
            overflow:auto;  
            margin-top:10px;
        }
        #table-wrapper table {
            width:100%;
        }
        #tableHist td, #tableHist th{
        	font-size: 18px; 
        }
        label
        {
        	font-size: 22px;
        	color: #26d626;
        	text-align: right;
        }
        .no
        {
        	height: 25px !important;
        	font-size: 16px !important;
        }
	</style>
</h:head>
<h:body>
	<h1><center>Cadastro de Vendas</center></h1>
	<div id="caixa">
		<f:metadata> 
             <f:viewParam name="vendaN" value="#{VendaBean.pedido.ID}" />
             <f:viewAction action="#{VendaBean.loadVenda()}"/>
        </f:metadata>
		<h:form id="cadastro">
			<h:messages />
			<table border="0" id="boxVenda">
				<tr>
					<td class="label">Cliente: </td>
					<td>
						<h:selectOneMenu value="#{VendaBean.pedido.codCliente}">
            				<f:selectItems value="#{ClienteBean.lista}" var="cli" 
            				itemValue="#{cli.codigo}" itemLabel="#{cli.nome}"/>
        				</h:selectOneMenu>
					</td>
				</tr>
				<tr>
					<td class="label">Produto: </td>
					<td>
						<h:selectOneMenu value="#{VendaBean.item.codProduto}" id="produto">
            				<f:selectItems value="#{ProdutoBean.lista}" var="prod" 
            				itemValue="#{prod.ID}" 
            				itemLabel="#{prod.nome} - R$ #{prod.preco}"/>
        				</h:selectOneMenu>
					</td>
				</tr>
				<tr>
					<td class="label">Quantidade: </td>
					<td>
						<h:inputText requiredMessage="informe uma quantidade" id="quantidade" required="true"
							value="#{VendaBean.item.quant}" converterMessage="Somente nÃºmeros"></h:inputText>
					</td>
					<td>
					
						<h:commandButton value="Adicionar">
                            <f:ajax 
                            	event="click"
                            	listener="#{VendaBean.adicionarItem}"
                                execute="cadastro:produto cadastro:quantidade"
                                render="cadastro:tableHist cadastro:valorAtual"
                            >
                            </f:ajax>
						</h:commandButton>
					
					</td>
				</tr>
			</table>
			<div class="historicoProdutos">
            	<div id="table-wrapper">
                	<div id="table-scroll">
                		<h:dataTable
                            value="#{VendaBean.pedido.items}"
                            var="item"
                            id="tableHist">
                            <h:column>
                                <f:facet name="header"></f:facet>#{item.numeracao}
                            </h:column>
                            <h:column> 
                                <f:facet name="header">Descricao</f:facet>#{item.produto.nome}
                            </h:column>
                            <h:column> 
                            	<f:facet name="header">Preco</f:facet>#{item.produto.precoS()}
                            </h:column>
                            <h:column> 
                            	<f:facet name="header">Quantidade</f:facet>#{item.quant}
                            </h:column>
                            <h:column> 
                            	<f:facet name="header">Total</f:facet>#{item.total()}
                            </h:column>
                            <h:column> 
                            	<h:commandButton value="Delete" styleClass="no">
                            		<f:ajax 
			                        	event="click"
			                           	listener="#{VendaBean.deletarItem(item.numeracao)}"
			                            render="@form cadastro:tableHist">
                    				</f:ajax>
                            	</h:commandButton>
                            </h:column>
                          </h:dataTable>
                     </div>
                 </div>
            </div>
			<div style="height: 30px; width:100%; margin-top: 23px; background: black;text-align: right; padding-top: 2px;">
				<h:outputLabel value="Valor Total: #{VendaBean.pedido.precoTotalS()}" id="valorAtual"></h:outputLabel>
			</div>
			<div class="botoes" style="width:100%; display: flex; margin-top: 10px;
			 	height: 45px; background: #d6d6da; border: solid 1px white;"> 
				               	<h:commandLink value="#{VendaBean.acao}" 
                        		styleClass="button" id="btnIncluir"
                        		action="#{VendaBean.incluirVenda}">
                        	</h:commandLink>
                            <h:link value="Cancelar" styleClass="cancelButton" outcome="listarVendas.xhtml"/>
			</div>
		</h:form>
	</div>
</h:body>
</html>